# 智能词汇复习助手 - 管理后台功能开发需求文档

**版本：V1.0**  
**更新时间：2025-01-05**

---

## 一、项目概览

### 1.1 系统架构
- **前端框架**：Next.js 15 + React 18 + TypeScript
- **UI组件库**：Ant Design 5.21
- **后端服务**：Next.js API Routes
- **数据库**：PostgreSQL + Prisma ORM
- **部署平台**：Vercel (Demo) / 阿里云 (生产)

### 1.2 用户角色
- **教师（管理员）**：拥有所有管理权限
- **学生（学习端）**：通过微信小程序访问

---

## 二、功能模块详述

### 模块一：用户认证系统 ✅

#### 1.1 登录功能 (已实现)
**文件位置**：`web-admin/app/login/page.tsx`

**功能描述**：
- 教师账号密码登录
- JWT Token 认证
- 本地存储用户信息

**API接口**：
- `POST /api/auth/login` - 登录接口
- `GET /api/auth/me` - 获取当前用户信息

**技术实现**：
- 使用 bcryptjs 进行密码加密
- JWT 生成和验证
- LocalStorage 存储 token

#### 1.2 首次初始化 (已实现)
**文件位置**：`web-admin/app/setup/page.tsx`

**功能描述**：
- 系统首次运行时创建管理员账号
- 初始化数据库表结构

**API接口**：
- `POST /api/setup` - 初始化系统
- `GET /api/health` - 健康检查

---

### 模块二：控制台/仪表板 ✅

**文件位置**：`web-admin/app/admin/page.tsx`

#### 2.1 数据统计卡片 (已实现)
**功能清单**：
- ✅ 词汇总数统计
- ✅ 学生总数统计
- ✅ 班级数量统计
- ⚠️ 今日学习统计（待完善API）

#### 2.2 快速操作入口 (已实现)
- ✅ 添加词汇
- ✅ 添加学生
- ✅ 创建班级
- ✅ 查看学习数据

#### 2.3 系统状态监控 (已实现)
- ✅ 数据库状态
- ✅ API服务状态
- ✅ 系统版本信息

**待优化**：
- 🔲 实时数据刷新（WebSocket 或轮询）
- 🔲 更详细的系统监控指标
- 🔲 告警通知功能

---

### 模块三：词库管理系统 ✅

**文件位置**：`web-admin/app/admin/vocabularies/page.tsx`

#### 3.1 词汇列表管理 (已实现)
**功能清单**：
- ✅ 词汇列表展示（分页、排序）
- ✅ 搜索单词功能
- ✅ 难度筛选（简单/中等/困难）
- ✅ 高频词筛选
- ✅ 批量选择和批量删除
- ✅ 导出功能（待完善）

**表格列信息**：
- 单词、词性、核心释义、音标、难度、高频词标识

#### 3.2 单词信息维护 (已实现)
**表单字段**：
- ✅ 单词（必填）
- ✅ 词性（多选：n./v./adj./adv./prep./pron./conj./interj.）
- ✅ 核心释义（必填）
- ✅ 延伸释义（可选）
- ✅ 音标（可选）
- ✅ 难度等级（必填：EASY/MEDIUM/HARD）
- ✅ 高考高频词标识（必填：是/否）

**API接口**：
- `GET /api/vocabularies` - 获取词汇列表
- `POST /api/vocabularies` - 添加词汇
- `PUT /api/vocabularies/[id]` - 更新词汇
- `DELETE /api/vocabularies/[id]` - 删除词汇

#### 3.3 待完善功能 🔲
- 🔲 **音频上传**：真人发音音频上传和管理
- 🔲 **图片上传**：实体图片上传（集成OSS）
- 🔲 **批量导入**：Excel批量导入词汇
- 🔲 **导出优化**：完善导出功能（Excel/PDF/Word）
- 🔲 **词汇标签**：增加词汇分类标签（高考、四级、六级等）
- 🔲 **例句管理**：为每个单词添加例句

---

### 模块四：题目管理系统 ⚠️

**文件位置**：`web-admin/app/admin/vocabularies/[id]/page.tsx`

#### 4.1 题目管理功能 (部分实现)
**当前状态**：
- ✅ 题目列表查看
- ✅ 题目详情展示
- ✅ 题目CRUD基本功能

**题目类型支持**：
1. **英选汉**：英文单词 + 4个汉语选项
2. **汉选英**：汉语释义 + 4个英文单词选项
3. **听音选词**：英文发音 + 4个英文单词选项
4. **选词填空**：英文句子挖空 + 4个单词选项

**API接口**：
- `GET /api/vocabularies/[id]/questions` - 获取词汇题目列表
- `POST /api/vocabularies/[id]/questions` - 添加题目
- `PUT /api/vocabularies/[id]/questions/[questionId]` - 更新题目
- `DELETE /api/vocabularies/[id]/questions/[questionId]` - 删除题目

#### 4.2 待完善功能 🔲
- 🔲 **题目批量生成**：AI自动生成题目（基于单词和释义）
- 🔲 **干扰项智能推荐**：自动推荐易混淆词作为干扰项
- 🔲 **题目质量评估**：统计题目正确率和区分度
- 🔲 **音频题目支持**：为听音选词题目上传音频
- 🔲 **题目预览**：在添加前预览题目效果
- 🔲 **题目复用**：从题库中选择已有题目

---

### 模块五：学生管理系统 ✅

**文件位置**：`web-admin/app/admin/students/page.tsx`

#### 5.1 学生列表管理 (已实现)
**功能清单**：
- ✅ 学生列表展示
- ✅ 单个学生添加
- ✅ 批量导入学生（Excel）
- ✅ 学生信息查看

**表格列信息**：
- 姓名、学号、年级、班级

**API接口**：
- `GET /api/students` - 获取学生列表
- `POST /api/students` - 添加学生
- `POST /api/students/import` - 批量导入学生
- `GET /api/students/[id]` - 获取学生详情
- `PUT /api/students/[id]` - 更新学生信息
- `DELETE /api/students/[id]` - 删除学生

#### 5.2 学生详情页 (已实现)
**文件位置**：`web-admin/app/admin/students/[id]/page.tsx`

**功能清单**：
- ✅ 学生基本信息
- ✅ 每日学习任务查看
- ✅ 错题本查看

**API接口**：
- `GET /api/students/[id]/daily-tasks` - 获取每日任务
- `GET /api/students/[id]/wrong-questions` - 获取错题记录

#### 5.3 待完善功能 🔲
- 🔲 **学生编辑**：完善学生信息编辑功能
- 🔲 **批量操作**：批量删除、批量分配班级
- 🔲 **学生分组**：按学习进度、能力分组
- 🔲 **密码重置**：管理员重置学生密码
- 🔲 **学习轨迹**：查看学生完整学习轨迹和时间线
- 🔲 **个性化设置**：为单个学生定制复习计划

---

### 模块六：班级管理系统 ✅

**文件位置**：`web-admin/app/admin/classes/page.tsx`

#### 6.1 班级列表管理 (已实现)
**功能清单**：
- ✅ 班级列表展示
- ✅ 创建班级
- ✅ 查看班级学生数

**表格列信息**：
- 班级名称、年级、学生数

**API接口**：
- `GET /api/classes` - 获取班级列表
- `POST /api/classes` - 创建班级

#### 6.2 待完善功能 🔲
- 🔲 **班级详情页**：查看班级内所有学生
- 🔲 **班级编辑**：修改班级信息
- 🔲 **班级删除**：删除班级（需处理学生关联）
- 🔲 **批量分配**：批量将学生分配到班级
- 🔲 **班级统计**：班级整体学习数据分析
- 🔲 **班级对比**：不同班级之间的数据对比

---

### 模块七：学习统计与数据分析 🔲

**文件位置**：`web-admin/app/admin/statistics/page.tsx`

#### 7.1 当前状态
**状态**：⚠️ 页面已创建，功能未实现（显示"学习统计功能开发中..."）

#### 7.2 待开发功能 🔲

##### 7.2.1 数据筛选器
- 🔲 按学生筛选
- 🔲 按班级筛选
- 🔲 按时间段筛选（今日/本周/本月/自定义）
- 🔲 按词汇筛选
- 🔲 按难度筛选

##### 7.2.2 学习数据统计
- 🔲 **完成率统计**：每日/每周/每月完成率
- 🔲 **正确率统计**：总体正确率、各难度正确率
- 🔲 **学习时长统计**：总学习时间、平均答题时间
- 🔲 **学习趋势图**：折线图展示学习数据变化
- 🔲 **热力图**：学习活跃时间分布

##### 7.2.3 错题分析
- 🔲 **高频错题排行**：按错误次数排序
- 🔲 **错题分布**：按词性、难度、类型分布
- 🔲 **易错词汇**：统计全班易错词汇Top 20
- 🔲 **错题率趋势**：错题率变化趋势图

##### 7.2.4 学生排名
- 🔲 **学习积分排行榜**：按学习量排名
- 🔲 **正确率排行榜**：按正确率排名
- 🔲 **进步榜**：按进步幅度排名
- 🔲 **连续学习天数排行**

##### 7.2.5 词汇掌握分析
- 🔲 **已掌握词汇统计**：各学生已掌握词汇数量
- 🔲 **待复习词汇统计**：需要复习的词汇数量
- 🔲 **重点难点词汇**：累计错误≥3次的词汇列表
- 🔲 **词汇掌握进度条**：可视化展示掌握进度

**需要的API接口** 🔲：
- `GET /api/study-records` - 获取学习记录（已有基础）
- `GET /api/statistics/overview` - 获取总览数据
- `GET /api/statistics/student/[id]` - 获取学生统计
- `GET /api/statistics/class/[id]` - 获取班级统计
- `GET /api/statistics/wrong-questions` - 错题分析
- `GET /api/statistics/vocabulary-mastery` - 词汇掌握情况

---

### 模块八：数据导出系统 ⚠️

#### 8.1 当前状态
**状态**：⚠️ 基础接口存在，功能不完善

#### 8.2 待完善功能 🔲

##### 8.2.1 学习报告导出
- 🔲 **Excel格式**：学生学习报告（单个/批量）
- 🔲 **PDF格式**：学生学习报告（带图表）
- 🔲 **Word格式**：学生学习报告（可编辑）

##### 8.2.2 错题本导出
- 🔲 **按学生导出**：单个学生完整错题本
- 🔲 **按班级导出**：班级错题汇总
- 🔲 **按词汇导出**：特定词汇的错题记录

##### 8.2.3 导出内容定制
- 🔲 **模板管理**：自定义导出模板
- 🔲 **字段选择**：选择需要导出的字段
- 🔲 **排序方式**：按单词/错误次数/时间排序
- 🔲 **样式定制**：表格样式、字体、颜色等

##### 8.2.4 批量导出
- 🔲 **批量学生报告**：一键导出全班学生报告
- 🔲 **打包下载**：多个文件打包成ZIP
- 🔲 **定时导出**：设置定时生成报告

**需要的API接口** 🔲：
- `GET /api/export/student-report` - 导出学生报告
- `GET /api/export/wrong-questions` - 导出错题本
- `GET /api/export/class-report` - 导出班级报告
- `GET /api/export/vocabulary-report` - 导出词汇统计
- `POST /api/export/batch` - 批量导出

**技术实现**：
- 使用 ExcelJS 生成 Excel
- 使用 jsPDF 生成 PDF
- 使用 docx 生成 Word

---

### 模块九：智能复习计划系统 ⚠️

#### 9.1 当前状态
**状态**：⚠️ 核心算法需要完善

**文件位置**：`web-admin/lib/ebbinghaus.ts`

#### 9.2 复习算法 (部分实现)

##### 9.2.1 艾宾浩斯遗忘曲线
**当前实现**：
- ✅ 基础时间间隔：1天、2天、4天、7天、15天
- ✅ 复习周期计算

**待完善**：
- 🔲 根据正确率动态调整复习间隔
- 🔲 考虑单词难度因素
- 🔲 个性化复习间隔（根据学生能力）

##### 9.2.2 单词筛选规则
**需求规则**：
- 🔲 连续3次正确率100% → 标记为"已掌握"
- 🔲 累计错误≥3次 → 标记为"重点难点"
- 🔲 重点难点优先安排复习
- 🔲 新学单词按计划纳入

##### 9.2.3 每日复习列表生成
- 🔲 根据复习周期自动生成
- 🔲 考虑学生当日学习量上限
- 🔲 难易搭配（简单、中等、困难）
- 🔲 新旧搭配（新词、复习词）

#### 9.3 教师干预功能 🔲
- 🔲 **手动添加词汇**：为指定学生添加额外复习词汇
- 🔲 **手动移除词汇**：从复习列表移除某个词汇
- 🔲 **调整优先级**：手动提升/降低词汇优先级
- 🔲 **批量操作**：批量调整多个学生的复习计划

#### 9.4 规则配置 🔲
- 🔲 **掌握标准配置**：自定义"已掌握"判定标准
- 🔲 **难点标准配置**：自定义"重点难点"判定标准
- 🔲 **每日学习量配置**：设置每日复习单词数量
- 🔲 **复习间隔配置**：自定义复习时间间隔
- 🔲 **中断时长配置**：设置多久未完成算"中断"

**需要的API接口** 🔲：
- `GET /api/review-plan/[studentId]` - 获取学生复习计划
- `POST /api/review-plan/generate` - 生成复习计划
- `PUT /api/review-plan/adjust` - 调整复习计划
- `GET /api/settings/review-rules` - 获取复习规则配置
- `PUT /api/settings/review-rules` - 更新复习规则配置

---

### 模块十：系统设置与配置 🔲

#### 10.1 待开发功能

##### 10.1.1 全局设置
- 🔲 **系统名称和Logo**
- 🔲 **默认密码设置**
- 🔲 **会话超时时间**
- 🔲 **数据保留策略**

##### 10.1.2 通知设置
- 🔲 **邮件通知**：学习报告、异常告警
- 🔲 **微信通知**：与小程序联动
- 🔲 **通知模板管理**

##### 10.1.3 权限管理
- 🔲 **角色管理**：管理员、普通教师等
- 🔲 **权限分配**：不同角色的功能权限
- 🔲 **操作日志**：记录管理员操作

##### 10.1.4 数据备份
- 🔲 **手动备份**：一键备份数据库
- 🔲 **定时备份**：设置自动备份计划
- 🔲 **数据恢复**：从备份恢复数据

---

## 三、技术优化建议

### 3.1 性能优化 🔲
- 🔲 实现数据缓存（Redis）
- 🔲 图片和音频CDN加速
- 🔲 懒加载和虚拟滚动
- 🔲 API响应压缩

### 3.2 用户体验优化 🔲
- 🔲 骨架屏加载状态
- 🔲 操作反馈动画
- 🔲 键盘快捷键支持
- 🔲 暗黑模式支持

### 3.3 数据安全 🔲
- 🔲 敏感数据加密存储
- 🔲 API访问频率限制
- 🔲 SQL注入防护
- 🔲 XSS攻击防护

### 3.4 监控与日志 🔲
- 🔲 错误监控（Sentry）
- 🔲 性能监控（APM）
- 🔲 用户行为分析
- 🔲 详细操作日志

---

## 四、开发优先级建议

### P0 - 核心必备（当前阶段）
1. ✅ 用户认证系统
2. ✅ 词汇管理（基础CRUD）
3. ✅ 学生管理（基础CRUD）
4. ✅ 班级管理（基础CRUD）
5. ⚠️ 智能复习算法完善

### P1 - 重要功能（下一阶段）
1. 🔲 学习统计与数据分析（完整实现）
2. 🔲 数据导出系统（Excel/PDF/Word）
3. 🔲 题目管理系统完善
4. 🔲 复习计划教师干预功能
5. 🔲 词汇音频和图片上传

### P2 - 增强功能（后续阶段）
1. 🔲 批量导入优化
2. 🔲 系统设置与配置
3. 🔲 通知系统
4. 🔲 权限管理
5. 🔲 AI智能出题

### P3 - 高级功能（长期规划）
1. 🔲 数据可视化大屏
2. 🔲 学生画像分析
3. 🔲 智能推荐系统
4. 🔲 多租户支持
5. 🔲 移动端适配

---

## 五、数据库模型补充

### 5.1 需要新增的表 🔲

#### StudyPlan（复习计划表）
```prisma
model StudyPlan {
  id          String   @id @default(cuid())
  studentId   String
  vocabularyId String
  planDate    DateTime // 计划复习日期
  status      String   // PENDING/COMPLETED/SKIPPED
  priority    Int      @default(0) // 优先级
  reviewCount Int      @default(0) // 已复习次数
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  student     Student  @relation(fields: [studentId], references: [id])
  vocabulary  Vocabulary @relation(fields: [vocabularyId], references: [id])
}
```

#### VocabularyMastery（词汇掌握度表）
```prisma
model VocabularyMastery {
  id              String   @id @default(cuid())
  studentId       String
  vocabularyId    String
  masteryLevel    String   // NOT_LEARNED/LEARNING/MASTERED
  correctStreak   Int      @default(0) // 连续正确次数
  wrongCount      Int      @default(0) // 累计错误次数
  lastReviewDate  DateTime?
  nextReviewDate  DateTime?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  student         Student  @relation(fields: [studentId], references: [id])
  vocabulary      Vocabulary @relation(fields: [vocabularyId], references: [id])
}
```

#### SystemSettings（系统设置表）
```prisma
model SystemSettings {
  id           String   @id @default(cuid())
  key          String   @unique
  value        String
  description  String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}
```

#### AuditLog（操作日志表）
```prisma
model AuditLog {
  id        String   @id @default(cuid())
  userId    String
  action    String   // CREATE/UPDATE/DELETE/EXPORT等
  resource  String   // VOCABULARY/STUDENT/CLASS等
  details   Json?
  ipAddress String?
  createdAt DateTime @default(now())
}
```

---

## 六、API接口清单

### 6.1 已实现接口 ✅
- `POST /api/auth/login`
- `GET /api/auth/me`
- `POST /api/auth/register`
- `POST /api/setup`
- `GET /api/health`
- `GET /api/vocabularies`
- `POST /api/vocabularies`
- `PUT /api/vocabularies/[id]`
- `DELETE /api/vocabularies/[id]`
- `GET /api/vocabularies/[id]/questions`
- `POST /api/vocabularies/[id]/questions`
- `PUT /api/vocabularies/[id]/questions/[questionId]`
- `DELETE /api/vocabularies/[id]/questions/[questionId]`
- `GET /api/students`
- `POST /api/students`
- `POST /api/students/import`
- `GET /api/students/[id]`
- `PUT /api/students/[id]`
- `DELETE /api/students/[id]`
- `GET /api/students/[id]/daily-tasks`
- `GET /api/students/[id]/wrong-questions`
- `GET /api/classes`
- `POST /api/classes`
- `GET /api/study-records`

### 6.2 待开发接口 🔲
详见各模块的"需要的API接口"部分

---

## 七、UI/UX 改进建议

### 7.1 已完成优化 ✅
- ✅ 左侧导航浅色渐变设计
- ✅ 整体UI设计风格现代化
- ✅ 卡片阴影和圆角优化
- ✅ 按钮渐变色和动效
- ✅ 表格样式优化
- ✅ 菜单项交互优化

### 7.2 待优化项 🔲
- 🔲 响应式设计完善（移动端适配）
- 🔲 无障碍访问支持
- 🔲 多语言支持（国际化）
- 🔲 主题切换功能
- 🔲 图表可视化组件
- 🔲 操作引导和帮助文档

---

## 八、测试与质量保证

### 8.1 当前测试覆盖 ⚠️
- ✅ E2E测试基础框架（Playwright）
- ⚠️ 测试用例覆盖不足

### 8.2 待补充测试 🔲
- 🔲 单元测试（Jest）
- 🔲 集成测试
- 🔲 API接口测试
- 🔲 性能测试
- 🔲 安全测试

---

## 九、部署与运维

### 9.1 当前部署方案
- **Demo环境**：Vercel
- **数据库**：Vercel Postgres

### 9.2 生产环境规划 🔲
- 🔲 阿里云ECS部署
- 🔲 阿里云RDS数据库
- 🔲 阿里云OSS对象存储
- 🔲 CDN加速配置
- 🔲 监控告警系统
- 🔲 自动化部署（CI/CD）

---

## 十、总结

### 已实现功能（✅ 约40%）
- 完整的认证系统
- 词汇管理基础功能
- 学生和班级管理基础功能
- 题目管理基础功能
- 控制台基础数据展示
- 现代化UI设计

### 待开发功能（🔲 约60%）
- **核心功能**：学习统计、数据导出、智能复习算法
- **增强功能**：批量操作、教师干预、规则配置
- **高级功能**：AI出题、数据分析、系统设置

### 下一步行动建议
1. **立即完成**：智能复习算法完善（P0）
2. **近期完成**：学习统计模块开发（P1）
3. **中期完成**：数据导出系统（P1）
4. **长期规划**：AI和高级分析功能（P3）

---

**文档维护**：本文档将随开发进度持续更新
**更新频率**：每完成一个主要功能模块后更新
