# Vercel Blob 上传功能测试清单

## 测试前准备

### 环境检查

- [ ] `.env.local` 包含 `BLOB_READ_WRITE_TOKEN`
- [ ] 开发服务器已启动 (`npm run dev`)
- [ ] 已登录教师账号
- [ ] 准备测试文件:
  - [ ] MP3 音频文件 (< 10MB)
  - [ ] JPEG/PNG 图片文件 (< 10MB)

## 音频上传测试

### 1. 文件上传模式

**步骤:**
1. 访问词汇详情页 (选择任意词汇)
2. 点击 "多媒体资源" 卡片
3. 切换到 "音频管理" Tab
4. 点击 "添加音频" 按钮
5. 确认默认选择 "上传文件" 模式
6. 点击 "选择文件" 按钮
7. 选择一个 MP3 音频文件
8. 选择口音 (美式/英式)
9. 点击 "保存" 按钮

**预期结果:**
- [ ] 文件上传成功提示
- [ ] 音频列表中显示新添加的音频
- [ ] 可以点击播放按钮播放音频
- [ ] 显示正确的口音标签 (🇺🇸 或 🇬🇧)

### 2. URL 输入模式

**步骤:**
1. 点击 "添加音频" 按钮
2. 切换到 "输入URL" 模式
3. 输入一个有效的音频 URL
4. 选择口音
5. 点击 "保存"

**预期结果:**
- [ ] URL 验证通过
- [ ] 音频添加成功
- [ ] 可以播放音频

### 3. 编辑音频

**步骤:**
1. 点击已添加音频的 "编辑" 按钮
2. 修改口音
3. 点击 "保存"

**预期结果:**
- [ ] 只能修改元数据,不能重新上传文件
- [ ] 音频 URL 字段显示为只读文本框
- [ ] 修改保存成功

### 4. 删除音频

**步骤:**
1. 点击音频的 "删除" 按钮
2. 确认删除

**预期结果:**
- [ ] 显示确认对话框
- [ ] 删除成功
- [ ] 音频从列表中移除

## 图片上传测试

### 1. 文件上传模式

**步骤:**
1. 在词汇详情页点击 "图片管理" Tab
2. 点击 "添加图片" 按钮
3. 确认默认选择 "上传文件" 模式
4. 点击上传区域选择图片
5. (可选)输入图片描述
6. 点击 "保存"

**预期结果:**
- [ ] 图片预览正确显示
- [ ] 上传成功提示
- [ ] 图片以卡片形式显示在网格中
- [ ] 图片可以正常查看(点击放大)

### 2. URL 输入模式

**步骤:**
1. 点击 "添加图片" 按钮
2. 切换到 "输入URL" 模式
3. 输入一个有效的图片 URL
4. 输入描述
5. 点击 "保存"

**预期结果:**
- [ ] URL 验证通过
- [ ] 图片添加成功
- [ ] 图片正常显示

### 3. 编辑图片

**步骤:**
1. 点击图片卡片的编辑图标
2. 修改描述
3. 点击 "保存"

**预期结果:**
- [ ] 只能修改描述,不能重新上传
- [ ] 图片 URL 字段显示为只读
- [ ] 修改保存成功

### 4. 删除图片

**步骤:**
1. 点击图片卡片的删除图标
2. 确认删除

**预期结果:**
- [ ] 显示确认对话框
- [ ] 删除成功
- [ ] 图片从网格中移除

## 边界测试

### 文件大小限制

**测试:**
- [ ] 尝试上传 > 10MB 的音频文件
- [ ] 尝试上传 > 10MB 的图片文件

**预期结果:**
- [ ] 显示 "文件大小不能超过10MB" 错误

### 文件格式验证

**测试音频:**
- [ ] 尝试上传 .txt 文件作为音频
- [ ] 尝试上传 .mp4 视频文件

**预期结果:**
- [ ] 显示 "不支持的音频格式" 错误

**测试图片:**
- [ ] 尝试上传 .txt 文件作为图片
- [ ] 尝试上传 .mp3 音频文件

**预期结果:**
- [ ] 显示 "不支持的图片格式" 错误

### 网络错误处理

**测试:**
- [ ] 断开网络后尝试上传文件

**预期结果:**
- [ ] 显示 "上传失败" 错误
- [ ] 不会创建数据库记录

### 权限验证

**测试:**
- [ ] 以学生账号登录尝试上传文件

**预期结果:**
- [ ] 显示权限错误
- [ ] 无法访问上传功能

## 集成测试

### 听音选词功能

**步骤:**
1. 为单词添加音频文件
2. 进入 "题目管理" → "听音选词" Tab
3. 点击已有题目的 "预览" 按钮

**预期结果:**
- [ ] 预览对话框显示 AudioPlayer 组件
- [ ] 可以点击播放音频
- [ ] 音频播放正常

### 数据持久化

**步骤:**
1. 上传音频和图片
2. 刷新页面
3. 重新访问词汇详情页

**预期结果:**
- [ ] 音频和图片列表正确加载
- [ ] 文件 URL 可访问
- [ ] 播放和显示功能正常

## 性能测试

### 上传速度

**测试:**
- [ ] 上传小文件 (< 1MB)
- [ ] 上传中等文件 (1-5MB)
- [ ] 上传大文件 (5-10MB)

**记录:**
- 小文件上传时间: _____ 秒
- 中等文件上传时间: _____ 秒
- 大文件上传时间: _____ 秒

### 并发上传

**测试:**
- [ ] 同时在两个 Tab 中上传文件

**预期结果:**
- [ ] 两个上传都成功
- [ ] 没有冲突或覆盖

## 用户体验测试

### UI/UX 检查

**音频管理:**
- [ ] 按钮和图标清晰易懂
- [ ] 加载状态有明确提示
- [ ] 错误信息有帮助性
- [ ] 操作反馈及时

**图片管理:**
- [ ] 图片预览清晰
- [ ] 卡片布局美观
- [ ] 响应式设计正常
- [ ] 交互流畅

### 多设备测试

**测试平台:**
- [ ] Chrome (桌面)
- [ ] Firefox (桌面)
- [ ] Safari (Mac)
- [ ] Edge (Windows)
- [ ] Chrome (移动端)
- [ ] Safari (iOS)

## 生产环境测试

### Vercel 部署验证

**步骤:**
1. 推送代码到 GitHub
2. 等待 Vercel 自动部署
3. 访问生产环境 URL
4. 重复上述所有测试

**检查项:**
- [ ] `BLOB_READ_WRITE_TOKEN` 环境变量已配置
- [ ] 文件上传到正确的 Blob 存储
- [ ] 文件 URL 可公开访问
- [ ] 所有功能正常工作

## 故障排查测试

### Token 配置问题

**测试:**
1. 移除 `BLOB_READ_WRITE_TOKEN` 环境变量
2. 重启开发服务器
3. 尝试上传文件

**预期结果:**
- [ ] 显示 "文件存储服务未配置" 错误
- [ ] 错误信息有指导性

### 重新配置 Token

**步骤:**
1. 添加正确的 Token
2. 重启开发服务器
3. 再次尝试上传

**预期结果:**
- [ ] 上传功能恢复正常

## 清理测试

### 存储清理

**步骤:**
1. 删除上传的测试文件
2. 检查 Vercel Blob Dashboard

**预期结果:**
- [ ] 文件从 Blob 存储中删除
- [ ] 存储空间正确释放

## 测试总结

**日期:** _______________
**测试人员:** _______________
**环境:** 开发环境 / 生产环境

**通过测试项:** _____ / _____
**失败测试项:** _____ / _____

**主要问题:**
1. ________________________________
2. ________________________________
3. ________________________________

**建议改进:**
1. ________________________________
2. ________________________________
3. ________________________________

**整体评价:** 通过 / 需要改进 / 失败

**备注:**
_______________________________________________
_______________________________________________
_______________________________________________
